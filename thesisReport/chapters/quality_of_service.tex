
\begin{comment}
comment from Manoj
- try to reference ISO/IEC 9126 for the quality attributes: refer to the slides sent by Manoj on Nov 02
- Also include the formula of the metrics and discuss about them and simplify them: refer to the slides sent by Manoj on Nov 02
- The quality attributes which can make more sense according to the priority to microservices: refer to the slides sent by Manoj on Nov 02
- Relationship between the quality attributes and their tradeoffs, what happens when we try to increase cohesion.. how it affect other attributes?
- create wiki page in the sebis page to document the literature review.

comment from Andrea
- mention about coupling created by calling same database directly by multiple microservice
use the formula to calculate quality metrics for the services at hybris to give an idea about good and bad service, the process of finding out good service at first and then using the quality metrics finding out the range of quality metrics, which can then be used to identify bad services
\end{comment}



\chapter{Quality Attributes of Microservices}\label{chapter:quality_of_service}
This chapter defines various quality attributes of the microservices. Also, it provides different quantitative approaches to evaluate the differnt quality attributes of the microservices. The Section \ref{section:quality_of_service/quality_attributes} presents a list of quality attributes compiled from various research papers. In Section \ref{section:quality_of_service/quality_metrics}, various metrics to evaluate these quality attributes are discussed. Furthermore, in Section \ref{section:quality_of_service/basic_quality_metrics}, a list of basic metrices (derived from the complex metrics discussed in section \ref{section:quality_of_service/quality_metrics}) shows the simplified way to determine the quality of the microservices. Again, Section \ref{section:quality_of_service/quality_attributes_principle} lists various principles to show the impact of various attributes on the quality of microservices. Finally, relationship amongst various quality attributes is discussed in Section \ref{section:quality_of_service/quality_attributes_relationship}.

\section{Introduction}\label{section:quality_of_service/introduction}
One of the various goals of software engineering is to develop application with high quality. In case of the applications following service oriented architecture, the complexity increases over time. So, for these applications, quality assessment becomes very crucial. \cite{Zhang:2009aa, Goeb:2011aa, Nematzadeh:2014aa} Quality models have been invented over time to evaluate quality of a software. A quality model is defined by quality attributes and quality metrics. Quality attributes are the expected properties of software artifacts defined by the chosen quality model. And, quality metrics give the techniques to measure the quality attributes. \cite{Mancioppi:2015aa} The software quality attributes can again be categorized into two types: a) internal attributes and b) external attributes. \cite{Mancioppi:2015aa, Briand:1996aa} The internal quality attributes are the design time attributes which needs to be fulfilled during the design of the software. Some of the internal quality attributes are loose coupling, cohesion, granularity, autonomy etc. \cite{Rostampour:2011aa, Sindhgatta:2015aa, Elhag:2014aa} On the other hand, external quality attributes are the traits of the software artifacts produced at the end of \acrshort{SDLC} (Software Development Life Cycle). Some of them are reusability, maintainability etc. \cite{Elhag:2014aa, Mancioppi:2015aa, Feuerlicht:2007aa, Feuerlicht:2013aa} The external quality attributes can only be measured after the end of development. However, it has been evident that internal quality attributes have huge impact upon the value of external quality attributes and thus can be used to predict them \cite{Henry:1990aa, Briand:2015aa, Alshayeb:2003aa, Bingu-Shim:2008aa}. The evaluation of both internal and external quality attributes are valuable in order to produce high quality software. \cite{Mancioppi:2015aa, Perepletchikov:2007aa, Mikhail-Perepletchikov:2015aa}

\section{Quality Attributes}\label{section:quality_of_service/quality_attributes}
As already mentioned in Section \ref{section:quality_of_service/introduction}, the internal and external quality attributes determine the overall quality of the service getting composed. There are different researches and studies which have been performed to find the factors affecting the service qualities. Based on the published research papers, a comprehensive Table \ref{tab:quality_of_service/quality_attributes} has been created. The table provides a minimum list of quality attributes which have been considerd in various research papers for determining the quality of the services. 

  \begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|c|c|c|c|c|c|}
  \hline
  \# & Attribute & \cite{Sindhgatta:2015aa} & \cite{Xiao-jun:2015aa} & \cite{Saad-Alahmari:2011aa} & \cite{Bingu-Shim:2008aa} & \cite{Ma:2009aa} & \cite{Feuerlicht:2007aa}\\
  \hline
  \hline
   1 & Coupling & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark\\ 
   2 & Cohesion & \checkmark & X & \checkmark & \checkmark & \checkmark & \checkmark\\
   3 & Autonomy & \checkmark & X & X & X & X & X\\
   4 & Granularity & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark\\
   5 & Reusability & \checkmark & X & X & \checkmark & X & \checkmark\\
   6 & Abstraction & \checkmark & X & X & X & X & X\\
   7 & Complexity & X & X & X & \checkmark & X & X\\
  \hline
\end{tabular}
\end{adjustbox}
  \caption{Quality Attributes}
  \label{tab:quality_of_service/quality_attributes}
\end{table}

The Table \ref{tab:quality_of_service/quality_attributes} gives an overview of the research papers around the quality attributes of the services. From the table, it can be deduced that most of the papers focus on coupling and granularity of the service and only few of them focus on other attributes such as complexity and autonomy.

Coupling refers to the dependency and interaction among services. The interaction becomes inevitable when a service requires a functionality provided by another service for accomplishing its own goals. Similarly, Cohesion of any system is the extent of appropriate arrangement of elements to perform the functionalities. It affects the degree of understandability and sensibility of its interface for its consumers. Whereas, the complexity attribute provides the way to evaluate the difficulty in understanding and reasoning the context of the service.\cite{Elhag:2014aa}
\\
The reusability attribute for a service measures the degree to which it can be used by multiple consumer services and can undergo multiple composition to accoplish various high order functionalities. \cite{Feuerlicht:2007aa}
\\
Autonomy is a broad term which refers to the ability of a service for a) self-containment, b) self-controlling, and c) self-governance. Autonomy defines the boundary and context of the service. \cite{Ma:2007aa} Finally, another important quality attribute is granularity and is described in Chapter \ref{chapter:granularity}. The basic signifance of granularity is the diversity and size of the functionalities offered by the service. \cite{Elhag:2014aa}

\section{Quality Metrics}\label{section:quality_of_service/quality_metrics}
There have been many researches conducted to define quality metrics for components. A major portion of the researches have been made for object oriented and component based architectural approaches. These metrics are refined to be used in service oriented systems \cite{Xiao-jun:2015aa, Sindhgatta:2015aa}. Firstly, various research papers defining the quality metrics of service oriented systems are collected. The research papers which have conducted their findings or proposition based on decent amount of scientific researches and have produced convincing result are only selected.\\
It is interesting to notice that the evaluation presented in the research papers are only performed using the case studies of their own but not real life scenarios. Moreover, they have used diversity of equations to define the quality metrics. Additionally, all the research papers do not focus on all the quality attributes. So, a fair comparision and selection of single dominant way to evaluate the quality metrics is difficult. Nevertheless, all of them do not discuss about the relationship between all the quality metrics \cite{Elhag:2014aa}.  This creates difficulty to map all the quality metrics into a common cohesive family. 
\\
Around such situation, this section facilitates the understanding of the quality metrics. Despite the case that there is no consensus on threshold value of quality metrics which defines the optimal quality level, the method discussed in this section can still be used to evaluate and compare the quality of microservices. This definitely helps to choose the identify good microservices based on various quality attributes. Furthermore, the quality metrics defined in research papers are quite complex to understand and apply. The complex metrics can be broken down further to the simple understandable terms called the  basic metrics. The basic metrics are the driving factors for the quality attributes and are also utilized by most of the the research papers to define the quality metrics.
\\
The remaining part of this section discusses the metrics definitions proposed in various research papers and analyzes them to identify their conceptual simplest form.

\subsection{Context and Notations}{\label{section:quality_of_service/quality_metrics/context_and_notations}

Before looking into the definitions of metrics, it can be helpful to know related terms, assumptions and their respective notations. 

\begin{itemize}[leftmargin=.5in]
\item the business domain is realized with various processes defined as $ P = \{p_1, p_2...p_s \} $
\item a set of services realizing the application is defined as $ S = \{s_1, s_2...s_s \} $; $s_s$ is the total number of services in the application
\item for any service $ s \epsilon S$, the set of operations provided by s is given by $O(s) = \{o_1, o_2,...o_o\}$ and $ |O(s)| $ = O
\item if an operation $ o \epsilon O(s) $ has a set of input and output messages given by M(o). Then the set of messages of all operations of the service is given by $ M(s) = \cup_{o \epsilon O(s)} M(o)$
\item the consumers of the service $ s \epsilon S $ is given by $ S_{consumer}(s) = \{ S_{c1}, S_{2},...S{{n_c}\}$; $n_c$ gives the number of consumer services
\item the producers for the service or the number of services to which the service $ s \epsilon S $ is dependent upon is given by $ S_{producer}(s) = \{ S_{c1}, S_{2},...S{{n_p}\}$; $n_p$ gives the number of producer services
\end{itemize}

\\
%coupling metrics
\subsection{Coupling Metrics}{\label{section:quality_of_service/quality_metrics/coupling}

\cite{Sindhgatta:2015aa} defines following metrics to determine coupling
$$ \acrshort{SOCI}(s) = number\_of\_operations\_invoked $$ $$ = | \{ o_{i} \epsilon s_{i}: \exists_{o \epsilon s} calls(o, o_{i}) \wedge s \neq s_{i} \} | $$

$$ \acrshort{ISCI}(s) = number\_of\_services\_invoked $$ $$ = | \{ s_{i} : \exists_{o \epsilon s}, \exists_{o_{i} \epsilon s_{i}} calls(o, o_{i}) \wedge s \neq s_{i} \} | $$

$$ \acrshort{SMCI}(s) = size\_of\_message\_required\_from\_other\_services $$ $$ = | \cup M (o_{i}) : ( o_{i} \epsilon s_{i}) \vee ( \exists_{o \epsilon s}, \exists_{o_{i} \epsilon s_{i} } calls(o, o_{i}) \wedge s \neq s_{i} ) | $$

where, \\
\begin{itemize}[leftmargin=.5in]
\item SOCI is Service Operation Coupling Index
\item ISCI is Inter Service Coupling Index
\item SMCI is Service Message Coupling Index
\item $ call(o, o_i) $ represents the call made from service 'o' to service '$o_i$'
\end{itemize}
\\
\cite{Xiao-jun:2015aa} defines 
$$Coupling(S_i) =  p \sum_{j=1}^{n_s} (-log(P_L(j)))$$
$$= \frac{1}{n} \sum_{j=1}^{n_s} (-log(P_L(j)))$$

where, \\
\begin{itemize}[leftmargin=.5in]
\item $n_s$ is the total number of services connected
\item 'n' is the total number of services in the entire application
\item $p = \frac{1}{n}$ gives the probability of a service participating in any connection
\end{itemize}
\\
\cite{Kazemi:2011aa} defines
$$Coupling = \frac{dependency\_on\_business\_entities\_of\_other\_services}{number\_of\_operations\_and\_ dependencies}$$ $$=\frac{\sum_{i \epsilon D_s} \sum_{k \epsilon O(s)}CCO(i,k)}{|O(s)|.K}$$
where, \\
\begin{itemize}[leftmargin=.5in]
\item $D_s = \{ D_1, D_2,...D_k \}$ is set of dependencies the service has on other services
\item $ K = |D_s| $
\item CCO is Conceptual Coupling betweeen service operations and obtained from BE X EBP (CRUD) matrix table constructed with business entities and business operations, where BE is business entity and EBP any logical process defined in an operation.
\end{itemize}

\cite{Bingu-Shim:2008aa} defines
$$coupling(s) =  \frac{number\_of\_services\_connected}{number\_of\_services} $$ $$ =\frac{n_c + n_p}{n_s}$$
where, \\
\begin{itemize}[leftmargin=.5in]
\item $n_c$ is number of consumer services
\item $n_p$ number of dependent services
\item $n_s$ total number of services
\end{itemize}
\cite{Saad-Alahmari:2011aa} defines
$$coupling = \frac{number\_of\_invocation}{number\_of\_services}$$ $$=\frac{\sum_{i=1}^{|O(s)|} (S_{i,sync} + S_{i,async})}{|S|}$$
\\
where,
\\
\begin{itemize}[leftmargin=.5in]
\item $S_{i,sync}$ is the synchronous invocation in the operation $O_i$
\item $S_{i,async}$ is the asynchronous invocation in the operation $O_i$
\end{itemize}


\begin{table}[h]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \normalsize
  \begin{tabular}{*{14}{|c}|}%%{|c|c|l|}
  \hline
  \# & Papers & Metrics Definition \\
  \hline
  \hline
   1 & \cite{Sindhgatta:2015aa} & 
                    \begin{tabular}{cl}
                    \multirow{6}{*}
                    &\acrshort{SOCI} : number of operation of other services \\
                    &invoked by the service\\
                    &\acrshort{ISCI} : number of services invoked \\
                    &by a service\\
                    &\acrshort{SMCI} : total number of messages from \\
                    &information model required by the operations\\
                    \end{tabular}\\
                    \hline
   2 & \cite{Xiao-jun:2015aa} &
                    \begin{tabular}{cl}
                    \multirow{6}{*}
                    &Coupling is evaluated as information entropy \\
                    &of a complex service\\
                    &component where entropy is calculated using various \\
                    &data such as total number of atomic components connected, \\
                    &total number of links to atomic \\ 
                    &components and total number of atomic components\\
                    \end{tabular}\\
                    \hline
   3 & \cite{Kazemi:2011aa} & 
                    \begin{tabular}{cl}
                    \multirow{7}{*}
                    &The coupling is measured by using the dependency \\
                    &of a service operations with operations of other \\
                    &services. Additionally, the dependency is considered \\
                    &to have different weight value for each kind of operation \\
                    &such as Create, Read, Update, Delete (CRUD) and based on \\
                    &the type of business entity involved. The weight is \\
                    &referred from the CRUD matrix constructed in the process.\\
                    \end{tabular}\\
                    \hline
   4 & \cite{Bingu-Shim:2008aa} & 
                    evaluated by the average number of directly connected services\\
  \hline
   5 & \cite{Saad-Alahmari:2011aa} & 
                    \begin{tabular}{cl}
                    \multirow{2}{*}
                    &defines coupling as the average number of synchronous and \\
                    &asynchronous invocations in all the operations of the service\\
                    \end{tabular}\\
                    \hline
\end{tabular}
\end{adjustbox}
  \caption{Coupling Metrics}
  \label{tab:quality_of_service/quality_attributes/coupling_metrics}
\end{table}
\\
The Table \ref{tab:quality_of_service/quality_attributes/coupling_metrics} shows simpler form of metrics proposed for coupling. Although, the table shows different way of evaluating coupling from different research papers, they somehow agree to the basic metrics to calculate coupling. It can be deduced that the metrics to evaluate coupling uses basic metrics such as a) number of operations, b) number of provider services, and c) number of messages.
\\

%cohesion metrics
\subsection{Cohesion Metrics}{\label{section:quality_of_service/quality_metrics/cohesion}

\cite{Sindhgatta:2015aa} defines following metric for cohesion.
$$ \acrshort{SFCI}(s) = \frac{number\_of\_operations\_using\_same\_message}{number\_of\_operations} $$ $$ = \frac{max (\mu(m) )}{|O(s)|} $$
\\
where,
\begin{itemize}[leftmargin=.5in]
\item SFCI is Service Functional Cohesion Index
\item the number of operations using a message 'm'  is $\mu(m)$ such that $ m \epsilon M(s) $ and |O(s)| > 0
%principle
\\The service is considered highly cohesive if all the operations use one common message. This implies that a higly cohesive  service operates on a small set of key business entities as guided by the messages and are  relavant to the service and all the operations operate on the same set of key business entities. \cite{Sindhgatta:2015aa}
\end{itemize}

\cite{Bingu-Shim:2008aa} defines
$$ cohesion =  \frac{n_s}{|M(s)|}$$

\cite{Perepletchikov:2007aa} defines

$$ \acrshort{SIDC} = \frac{number\_of\_operations\_sharing\_same\_parameter}{total\_number\_of\_parameters\_in\_service} $$ $$ = \frac{ n_{op} }{n_{pt}} $$

$$ \acrshort{SIUC} = \frac{sum\_of\_number\_of\_operations\_used\_by\_each\_consumer}{product\_of\_total\_no\_of\_consumers\_and\_operations} $$ $$= \frac{n_{oc}}{n_c * |O(s)|}$$

$$ SSUC = \frac{sum\_of\_number\_of\_sequentials\_operations\_accessed\_by\_each\_consumer}{product\_of\_total\_no\_of\_consumers\_and\_operations} $$ $$=\frac{n_{so}}{n_c * |O(s)|}$$

\\where,
\begin{itemize}[leftmargin=.5in]
\item SIDC is Service Interface Data Cohesion
\item SIUC is Service Interface Usage Cohesion
\item SSUC is Service Sequential Usage Cohesion
\item $n_{op}$ is the number of operations in the service which share the same parameter types
\item $n_{pt}$ is the total number of distinct parameter types in the service
\item $n_{oc}$ is the total number of operations in the service used by consumers
\item $n_{so}$ is the total number of sequentially accessed operations by the clients of the service
\end{itemize}
\cite{Saad-Alahmari:2011aa} defines
$$ cohesion = \frac{max(\mu(\acrshort{OFG}, \acrshort{ODG}))}{|O(s)|} $$

\\
where,
\\
\begin{itemize}[leftmargin=.5in]
\item \acrshort{OFG} and \acrshort{ODG} are Operation Gunctionality Granularity and Operation Data Granularity respectively as calculated in Section \ref{section:quality_of_service/quality_metrics/granularity}
\item $\mu(\acrshort{OFG}, \acrshort{ODG})$ gives the number of operations with specific value of \acrshort{OFG} and \acrshort{ODG}
\end{itemize}

\begin{table}[h]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|l|}
  \hline
  \# & Papers & Metrics Definition \\
  \hline
  \hline
   1 & \cite{Sindhgatta:2015aa} & 
                    \begin{tabular}{cl}
                    \multirow{3}{*}
                    &defines \acrshort{SFCI} which measures the fraction of operations \\
                    &using similar messages out of total  number of operations in the \\
                    &service operations of the service\\
                    \end{tabular}\\
                    \hline
   2 & \cite{Perepletchikov:2007aa} &
                    \begin{tabular}{cl}
                    \multirow{8}{*}
                    &\acrshort{SIDC} : defines cohesiveness as the fraction of operations \\
                    &based on commonality of the messages they operate on\\
                    &\acrshort{SIUC} : defines the degree of consumption pattern of \\
                    &the service operations which is based on the similarity of consumers\\
                    &of the operations\\ 
                    &\acrshort{SSUC} : defines the cohesion based on the sequential\\
                    &consumption behavior of more than one operations of a service by\\
                    &other services\\
                    \end{tabular}\\
                    \hline
   3 & \cite{Bingu-Shim:2008aa} & 
                    \begin{tabular}{cl}
                    \multirow{2}{*}
                    &cohesion is evaluated by the inverse of average number of consumed \\
                    &messages by a service\\
                    \end{tabular}\\
                    \hline
   4 & \cite{Saad-Alahmari:2011aa} & 
                    \begin{tabular}{cl}
                    \multirow{4}{*}
                    &cohesion is defined as the consensus among the operations of \\
                    &the service regarding the functionality and data granularity \\
                    &which represents the type of parameters and the operations \\
                    &importance as calculated in the Section
                    \ref{section:quality_of_service/quality_metrics/granularity}\\
                    \end{tabular}\\
                    \hline
\end{tabular}
\end{adjustbox}
  \caption{Cohesion Metrics}
  \label{tab:quality_of_service/quality_attributes/cohesion_metrics}
\end{table}
\\
The Table \ref{tab:quality_of_service/quality_attributes/cohesion_metrics} gives simplified view for the cohesion metrics. The papers presented agree on some basic metrics such as a) similarity of the operation usage behavior, b) commanility in the messages consumed by operations and c) similarity in the size of operations.
\\


%granularity metrics
\subsection{Granularity Metrics}{\label{section:quality_of_service/quality_metrics/granularity}

\cite{Sindhgatta:2015aa} defines
$$ \acrshort{SCG} = number\_of\_operations = |O(s)| $$ 
$$ \acrshort{SDG} = size\_of\_messages =|M(s)| $$
where,
\begin{itemize}[leftmargin=.5in]
\item SCG is Service Capability Granularity
\item SDG is Service Data Granularity
\end{itemize}

\cite{Bingu-Shim:2008aa} defines
$$ granularity = \frac{number\_of\_operations}{size\_of\_messages} = \frac{|O(s)|^2}{|M(s)|^2}$$

\cite{Saad-Alahmari:2011aa} defines

$$ ODG = fraction\_of\_total\_weight\_of\_input\_and\_output\_parameters $$ $$ = \bigg( \frac{ \sum_{i=1}^{n_io} W_{pi}}{ \sum_{i=1}^{n_is} W_{pi}} + \frac{\sum_{j=1}^{n_jo} W_{pj}}{ \sum_{j=1}^{n_js} W_{pj}} \bigg)$$

$$ OFG = complexity\_weightage\_of\_operation = \frac{W_i(o)}{ \sum_{i=1}^{|O(S)|}W_i(o)}$


$$ granularity = sum\_of\_product\_of\_data\_and\_functionality\_granularity $$ $$= \sum_{i=1}^{|O(S)|} ODG(i) * OFG(i) $$
\\
where,
\\
\begin{itemize}[leftmargin=.5in]
\item ODG is Operation Data Granularity
\item OFG is Operation Functionality Granularity
\item $W_{pi}$ is the weight of input parameter
\item $W_{pj}$ is the weight of output parameter
\item $n_io$ is the number of input parameters in an operation
\item $n_jo$ is the number of output parameters in an operation
\item $n_is$ is the total number of input parameters in the service
\item $n_js$ is the total number of output parameters in the service
\item $W_i(o)$ is the weight of an operation of the service
\item $ |O(S)| $ is the number operations in the service
\end{itemize}

\begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|l|}
  \hline
  \# & Papers & Metrics Definition \\
  \hline
  \hline
   1 & \cite{Sindhgatta:2015aa} & 
                    \begin{tabular}{cl}
                    \multirow{3}{*}
                    &the service capability granularity is calculated by the number of\\
                    &operations in a service and the data granularity by the\\ 
                    &number of messages consumed by the operations of the service\\
                    \end{tabular}\\
                    \hline
   2 & \cite{Saad-Alahmari:2011aa} &
                    \begin{tabular}{cl}
                    \multirow{8}{*}
                    &\acrshort{ODG} : evaluated in terms of number of input and\\
                    &output parameters and their type such as simple,\\ 
                    &user-defined and complex\\
                    &\acrshort{OFG} : defined as the level of logic provided by\\
                    &the operations of the services\\
                    &\acrshort{SOG} : defined by the sum of product of data \\
                    &granularity and functionality granularity for all operations\\
                    &in the service\\
                    \end{tabular}\\
                    \hline
   3 & \cite{Bingu-Shim:2008aa} & 
                    \begin{tabular}{cl}
                    \multirow{3}{*}
                    &evaluated as the ratio of squared number of operations of\\
                    &the service to the squared number of messages consumed by\\ 
                    &the service\\
                    \end{tabular}\\
                    \hline
\end{tabular}
\end{adjustbox}
  \caption{Granularity Metrics}
  \label{tab:quality_of_service/quality_attributes/granularity_metrics}
\end{table}
\\
The Table \ref{tab:quality_of_service/quality_attributes/granularity_metrics} presents various view of granularity metrics based on different research papers. Based on the Table \ref{tab:quality_of_service/quality_attributes/granularity_metrics}, the granularity is evaluated using some basic metrics such as a) the number and type of the parameters, b) number of operations and c) number of messages consumed.
\\

%Complexity metrics
\subsection{Complexity Metrics}{\label{section:quality_of_service/quality_metrics/complexity}

\cite{Zhang:2009aa} defines
$$ \acrshort{RIS} = \frac{IS(s_i)}{|S|}$$

\\

$$  \acrshort{RCS} = \frac{coupling\_of\_service}{number\_of\_services} = \frac{CS(s_i)}{|S|}$$

\\
where,
\\
\begin{itemize}[leftmargin=.5in]
\item $CS(s_i)$ gives coupling value of a service
\item |S| is the number of services to realize the application
\item $IS(s_i)$ gives importance weight of a service in an application
\end{itemize}

The complexity is rather obtained by relative coupling than by coupling on its own. A low value of RCS indicates that the coupling is lower than the count of services where as RCS with value 1 indicates that the coupling is equal to the number of services. This represents high amount of complexity.
\\
Similarly, a high value of RIS indicates that a lot of services are dependent upon the service and the service is of critical value for other services. This increases complexity as any changes or problem in the service affects a large number of services to a high extent.
\\
\cite{Saad-Alahmari:2011aa} defines
$$ Complexity(s) = \frac{Service\_Granularity}{number\_of\_services} $$ $$ =\frac{\sum_{i=1}^{|O(s)|}(SG(i))^2}{|S|}$$
\\
where,
\\
\begin{itemize}[leftmargin=.5in]
\item |S| is the number of services to realize the application
\item SG(i) gives the granularity of ith service 
\\calculated as described in Section \ref{section:quality_of_service/quality_metrics/granularity}
\end{itemize}


\begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|l|}
  \hline
  \# & Papers & Metrics Definition \\
  \hline
  \hline
   1 & \cite{Zhang:2009aa} & 
                    \begin{tabular}{cl}
                    \multirow{6}{*}
                    &\acrshort{RCS} : complexity evaluated by the degree of coupling\\ 
                    &for a service and evaluated as the fraction of its coupling\\
                    &to the total number of services\\
                    &\acrshort{RIS} : measured as the fraction of total \\
                    &dependency weight of consumers upon the service to the total\\
                    &number of services\\
                    \end{tabular}\\
                    \hline
   2 & \cite{Saad-Alahmari:2011aa} & 
                    \begin{tabular}{cl}
                    \multirow{2}{*}
                    &the complexity is calculated using the granunarity of service\\
                    &operations\\
                    \end{tabular}\\
  \hline
\end{tabular}
\end{adjustbox}
  \caption{Complexity Metrics}
  \label{tab:quality_of_service/quality_attributes/complexity_metrics}
\end{table}
\\
The Table \ref{tab:quality_of_service/quality_attributes/complexity_metrics} provides the way to interprete complexity metrics. The complexity is highly dependent upong a) coupling and b) functionality granularity of the service.
\\
%Autonomy metrics
\subsection{Autonomy Metrics}{\label{section:quality_of_service/quality_metrics/autonomy}
\cite{Rostampour:2011aa} defines

$$ Self-Containment (SLC) = sum\_of\_CRUD\_coefficients\_for\_each\_Business\_entity $$ $$ =\frac{1}{h_2 - l_2 + 1} \sum_{i= l_2}^{h_2} \sum_{sr \epsilon SR} (BE_{i,sr} X V_{sr})$$


$$ Dependency (DEP) = dependency\_of\_service\_on\_other\_service\_business\_entities $$ $$ =\frac{\sum_{j=L1_i}^{h1_i} \sum_{k=1}^{BE} V_{sr_{jk}} - \sum_{j=L1_i}^{h1_i} \sum_{k=L2_i}^{j2_i} V_{sr_{jk}} }{nc}$$

$$
\mbox{autonomy}=\left\{
\begin{array}{rl}
\acrshort{SLC} - \acrshort{DEP} & \mbox{if SLC > DEP} \\
0 & \mbox{otherwise}
\end{array} \right.
$$

\\
where,
\\
\begin{itemize}[leftmargin=.5in]
\item nc is the number of relations with other services
\item $BE_{i,sr} = 1$ if the service performs action sr on the ith BE and sr represents any CRUD operation and $V_{sr}$ is the coefficient depending upon the type of action
\item $ V_{sr_{jk} $ is the corresponding value of the action in jkth element of CRUD matrix, it gives the weight of corresponding business capability affecting a business entity
\item $ l1_i, h1_i, l2_i, h2_i$ are bounding indices in CRUD matrix of ith service
\end{itemize}
 
\begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|l|}
  \hline
  \# & Papers & Metrics Definition \\
  \hline
  \hline
   1 & \cite{Rostampour:2011aa} & 
                   \begin{tabular}{cl}
                    \multirow{6}{*}
                    &\acrshort{SLC} : defined as the degree of control of a \\
                    &service upon its operations to act on its Business entities only\\
                    &\acrshort{DEP} : given by the degree of coupling of the \\
                    &service with other services\\
                    &autonomy is given by the difference of \acrshort{SLC} and \acrshort{DEP}\\
                    &if SLC > DEP else it is taken as 0\\
                    \end{tabular}\\
                    \hline
\end{tabular}
\end{adjustbox}
  \caption{Autonomy Metrics}
  \label{tab:quality_of_service/quality_attributes/autonomy_metrics}
\end{table}
\\
The Table \ref{tab:quality_of_service/quality_attributes/autonomy_metrics} shows a way to interprete autonomy. It is calculated by the difference \acrshort{SLC}-\acrshort{DEP} when \acrshort{SLC} is greater than \acrshort{DEP}. In other cases it is taken as zero. So, autonomy increases as the operations of the services have full control upon its business entities but decreases if the service is dependent upon other services.
\\
%Reusability metrics
\subsection{Reusability Metrics}{\label{section:quality_of_service/quality_metrics/reusability}
\cite{Sindhgatta:2015aa} defines

$$ Reusability = number\_of\_existing\_consumers $$ $$ =|S_{consumers}| $$
%P + Q $$ where,
%$$ P = | \{ s_{i} : \exists_{o \epsilon s} , \exists_{o_{i} \epsilon s_{i}} calls(o_{i}, o) \wedge s \neq %s_{i}} \}|$$ and
%$$ Q = |\{ p \epsilon P : s \epsilon p \}|$$

\\ \cite{Bingu-Shim:2008aa} defines 
$$Reusability= \frac{Cohesion - granularity + Consumability - coupling}{2}$$
\begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|l|}
  \hline
  \# & Papers & Metrics Definition \\
  \hline
  \hline
   1 & \cite{Sindhgatta:2015aa} & 
                    \begin{tabular}{cl}
                    \multirow{2}{*}
                    &\acrshort{SRI} defines reusability as the number of existing\\ 
                    &consumers of the service\\
                    \end{tabular}\\
                    \hline
   2 & \cite{Bingu-Shim:2008aa} & 
                    \begin{tabular}{cl}
                    \multirow{4}{*}
                    &evaluated from coupling, cohesion, granularity and \\
                    &consumability of a service where consumability is the chance \\
                    &of the service being discovered and depends upon the fraction\\
                    &of operations in the service\\
                    \end{tabular}\\
                    \hline
                    \end{tabular}
\end{adjustbox}
  \caption{Reusability Metrics}
  \label{tab:quality_of_service/quality_attributes/reusability_metrics}
\end{table}
\\
The table \ref{tab:quality_of_service/quality_attributes/reusability_metrics} shows the reusability metrics evaluation. Reusability depends upon a) coupling, b) cohesion and c) granularity. It decreases as coupling and granularity increases.
\\


%Basic Metrics
\section{Basic Quality Metrics}{\label{section:quality_of_service/basic_quality_metrics}
The Section \ref{section:quality_of_service/quality_metrics} presents various quality metrics to evaluate quality attributes based upon different research papers. The metrics are analyzed the metrics in order to derive them in simplest form possible. Eventually, the tables demonstrating the simplest definitions of the metrics, shows that the quality attributes are measured on the basis of some basic metrics. Based on the Section \ref{section:quality_of_service/quality_metrics} and based on the research papers, this section lists basic metrics.
\\

\begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|l|c||c||c||c||c||c|}
  \hline
  \# & Metrics & \begin{sideways}Coupling\end{sideways}
  &  \begin{sideways}Cohesion\end{sideways}
  & \begin{sideways}Granularity\end{sideways}
  & \begin{sideways}Complexity\end{sideways} 
  & \begin{sideways}Autonomy\end{sideways}
  & \begin{sideways}Reusability\end{sideways} \\
  \hline
  \hline
    1 & number of service operations invoked by the service 
     & +
     & 
     & 
     & +
     & -
     & -\\
                    \hline
    2 & number of operation using similar messages
     & 
     & +
     & 
     & 
     & 
     & +\\
\hline
    3 & number of operation used by same consumer
     & 
     & +
     & 
     & 
     & 
     & +\\
     \hline
    4 & number of operation using similar parameters
     & 
     & +
     & 
     & 
     & 
     & +\\
     \hline
    5 & number of operation with similar scope or capability
     & 
     & +
     & 
     & 
     & 
     & +\\
     \hline
    6 & scope of operation
     & 
     & 
     & +
     & +
     & 
     & -\\
     \hline
     7 & number of operations
     & 
     & 
     & +
     & +
     & 
     & -\\
     \hline
     8 & number of parameters in operation
     & 
     & 
     & +
     & +
     & 
     & -\\
     \hline
    9 & type of parameters in operation
     & 
     & 
     & +
     & +
     & 
     & -\\
     \hline
     10 & number and size of messages used by operations
     & +
     & 
     & +
     & +
     & -
     & -\\
     \hline
     11 & type of messages used by operations
     & 
     & +
     & 
     & 
     & 
     & +\\
     \hline
     12 & number of consumer services
     & +
     & 
     & 
     & +
     & -
     & +\\
     \hline
     13 & number of producer services
     & +
     & 
     & 
     & +
     & -
     & -\\
     \hline
     14 & type of operation and business entity invoked by the service
     & +
     & 
     & 
     & +
     & -
     & -\\
     \hline
     15 & number of consumers accessing same operation
     & 
     & +
     & 
     & 
     & 
     & +\\
     \hline
     16 & number of consumer with similar operation usage sequence
     & 
     & +
     & 
     & 
     & 
     & +\\
     \hline
     17 & dependency degree or imporance of service operation to other service
     & 
     & 
     & 
     & +
     & 
     & \\
     \hline
     18 & degree of control of operation to its business entities
     & 
     & 
     & 
     & 
     & +
     & \\
     \hline
     \hline
\end{tabular}
\end{adjustbox}
  \caption{Basic Quality Metrics}
  \label{tab:quality_of_service/quality_attributes/basic_quality_metrics}
  \\
  Additionally, the effect of the basic metrics upon various quality attributes are also evaluated and stated under each column such as 'coupling', 'cohesion' etc.
  Here, the meaning of the various symbols to demonstrate the affect are as listed below:
  \\
\begin{itemize}[leftmargin=.5in]
\item + the basic metric affect the quality attribute proportionlly
\item - the basic metric inversely affect the quality attribute
\item   there is no evidence found regarding the relationship from the papers
\end{itemize}
\end{table}
Considering the Table \ref{tab:quality_of_service/quality_attributes/basic_quality_metrics}, it can be deduced that cohesion of a service increases with the number of operations using similar messages, using similar parameters and serving same consumer. The same process can be followed for other quality attributes.

%principles based on quality quality attributes
\section{Principles based on Quality Attributes}{\label{section:quality_of_service/quality_attributes_principle}
The Section \ref{section:quality_of_service/introduction} has already mentioned that there are two distinct kind of quality attributes: external and internal. The external quality attributes cannot be evaluated during design however can be predicted using the internal quality attributes. This kind of relationship can be used to design the services with good quality. Moreover, it is important to identify how each internal attributes affect the external attributes. The understanding of such relationship will be helpful to determine the combined effect of the quality attributes and to identify the service with appropriate level of quality based on the requirement.
The remaining part of the section lists some principles to show existing relationship among various quality attributes and the desired value of the quality attributes for the services.
\begin{enumerate}
\item When a service has large number of operations, it means it has large number of consumers. It will highly affect maintainability because a small change in the operations of the service will be propagated to large number of consumers. But again, if the service is too fine granular, there will be high network coupling. \cite{Feuerlicht:2007aa, Xiao-jun:2015aa, Bianco:2007aa}

\item Low coupling improves understandability, reusability and scalability where as high coupling decreases maintainability
\\
\cite{Kazemi:2011aa, Erl:2005aa, Josuttis:2007aa}.

\item A good strategy for grouping operations to realize a service is to combine the ones those are used together.  This indicates that most of the operations are used by same client.  It highly improves maintainability by limiting the number of affected consumer in the event of change in the service. \cite{Xiao-jun:2015aa}

\item A high cohesive quality attribute defines a good service. The service is easy to understand, test, change and is more stable. These properties highly support maintainability. {enumerate}\cite{np:2001aa}

\item A service with operations those are cohesive and have low coupling, make the service reusable \cite{Washizakia:2003aa, Feuerlicht:2007aa, Ma:2009aa}.

\item Services must be selected in a way so that they focus on a single business functionality. This highly follows the concept of low coupling. \cite{Perepletchikov:2007aa, Sindhgatta:2015aa}

\item Maintainability is divided into four distinct concepts:  analyzability, changeability, stability and testability \cite{np:2001aa}. A highly cohesive and low-coupled design should be easy to analyze and test. Moreover,  such a system will be stable and easy to change. \cite{Perepletchikov:2007aa}


\item The complexity of a service is determined by granularity. A coarse-grained service has higher complexity. However, as the size of the service decreases, the complexity of the over system governance also increases.
\cite{Saad-Alahmari:2011aa}

\item The complexity depends upon coupling. The complexity of a service is defined in terms of the number of dependencies of a service, number of operations as well as number and size of messages used by the service operations. 
\\
\cite{Saad-Alahmari:2011aa, Sindhgatta:2015aa, Lee:2001aa}

\item The selection of an appropriate service has to deal with multi-objective optimization problem.  The quality attributes are not independent in all aspects. Depending upon goals of the architecture, tradeoffs have to be made for mutually exclusive attributes. For example, when choosing between coarse-grained and fine-grained service, various factors such as governance, high network roundtrip etc. also should be considered. 
\cite{Jamshidi:2008aa}

\item Business entity convergence of a service, which is the degree of control over specific business entities, is an important quality for the selection of service. For example: It is be better to create a single service to create and update an order. In that way change and control over the business entity is localized to a single service.\cite{Ma:2009aa}

\item Increasing the granularity decreases cohesion but also decreases the amount of message flow across the network. This is because, as the boundary of the service increases, more communication is handled within the service boundary. However, this can be true again only if highly related operations are merged to build the service. This suggests for the optimum granularity by handling cohesion and coupling in an appropriate level.\cite{Ma:2009aa, Bianco:2007aa}

\item As the scope of the functionality provided by the service increases, the reusability decreases \cite{Feuerlicht:2007aa}.

\item If the service has high interface granularity, the operations operates on coarse-grained messages. This can affect the service performance. On the other hand, if the service has too fine-grained interface, then there will be a lot of messages required for the same task, which then can again affect the overall performance. \cite{Bianco:2007aa}


\end{enumerate}


%relationship between quality attributes and tradeoffs
\section{Relationship among Quality Attributes}{\label{section:quality_of_service/quality_attributes_relationship}
In order to determine the appropriate level of quality for a service, it is also important to know the relationship between various quality attributes. This knowledge will be helpful to decide tradeoffs among the quality attributes in the situation when it is not possible to achieve best of all. Based on the Section \ref{section:quality_of_service/quality_attributes} and Section \ref{section:quality_of_service/quality_attributes_principle}, the identified relationship among the quality attributes are shown in the Table \ref{tab:quality_of_service/quality_attributes/quality_attributes_relationship}.

\begin{table}[h!]
  \centering
  \begin{adjustbox}{max width=\textwidth}
  \begin{tabular}{*{14}{|c}|}%%{|c|c|c|c|c|}
  \hline
  \# & Quality Attributes & Coupling & Cohesion & Granularity \\
  \hline
  \hline
   1 & Coupling         &   & - & + \\ \hline
   2 & Cohesion         & - &   &   \\ \hline
   3 & Granularity      & + &   &   \\ \hline
   4 & Complexity       & + &   & + \\ \hline
   5 & Reusability      & - & + & - \\ \hline
   6 & Autonomy         & - &   &   \\ \hline
   7 & Maintainability  & - & + & - \\ \hline
   \hline
   \end{tabular}
\end{adjustbox}
  \caption{Relationship among quality attributes}
  \label{tab:quality_of_service/quality_attributes/quality_attributes_relationship}
\end{table}

Here, the meaning of the various symbols showing nature of relationship are as listed below:
  \\
\begin{itemize}[leftmargin=.5in]
\item + the quality attribute on the column affects the quality attribute on the corresponding row positively
\item - the quality attribute on the column affects the quality attribute on the corresponding row inversely
\item   there is no enough evidence found regarding the relationship from the papers or these are same attributes
\end{itemize}
Based on the Table \ref{tab:quality_of_service/quality_attributes/quality_attributes_relationship}, if granularity of a microservice increases then coupling of other microservices on it, will also increase. Similarly, relationship among other quality attributes can also be derived using the table.
The idea regarding impact of various quality attributes amongst each other can be helpful to make decision regarding trade offs.

\section{Conclusion}\label{section:quality_of_service/conclusion}
There is no doubt that granularity is an important aspect of a microservice however there are other different factors such as coupling, cohesion etc. which affect granularity as well as the overall quality of the service. Again, knowing the way to evaluate these qualities in terms of a quantitative figure can be helpful for easy decision regarding quality. However, most of the metrices are quite complex so the Section \ref{section:quality_of_service/basic_quality_metrics} compiled these complex mectrics in terms of simple metrices. The factors used to define these basic metrices are the ones which are easily accessible to developers and architects during desigin and development phases. So, these basic metrices can be an efficient and easy way to determine quality of microservices. \\
Moreover, the external quality attributes such as reusability, scalability etc can be controlled by fixing internal quality attributes such as coupling, cohesion, autonomy etc. So, finding an easy way to evaluate and fix internal quality attributes can eventually make it easier to achieve microservices with satisfactory value of external quality attributes.\\
Nevertheless, the quality attributes are not mutually exclusive but are dependent on each other. The Table \ref{tab:quality_of_service/quality_attributes/quality_attributes_relationship} shows basic relationship among them. The table can be helpful when needed to perform trade-offs among various quality attributes depending upon goals.
\section{Problem Statement}\label{section:quality_of_service/problem_statement}
Having collected important concepts regarding various quality attributes, which is one of the major drivers for defining architecture as mentioned in Section \ref{section:context/approach}, the next important concept is to find the process of modeling microservices as stated in the Table \ref{tab:context/microservices_architecture_style/keywords_extracted_from_various_definitions_of_microservice}. The quality attributes can be a major input for deciding the process of identifying microservices in a problem domain.

